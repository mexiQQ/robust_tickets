Namespace(adam_epsilon=1e-08, adv_change_rate=0.2, adv_init_mag=0.05, adv_lr=0.03, adv_max_norm=0, adv_norm_type='l2', adv_steps=5, bias_correction=True, bsz=32, ckpt_dir=PosixPath('save_models/search_ticket'), dataset_name='glue', debug=False, do_lower_case=True, epochs=20, eval_size=32, force_overwrite=True, in_w_per_mask=1, lambda_amp=0.5, lambda_final=1, lambda_init=0, lambda_startup_frac=0.1, lambda_warmup_frac=0.3, lr=0.1, mask_p=0.9, max_grad_norm=1, max_seq_length=128, model_name='/hdd1/jianwei/workspace/robust_ticket/save_models/fine-tune/finetune_bert-base-uncased_glue-sst2_lr2e-05_epochs3_seed42', model_type='bert', num_labels=2, out_w_per_mask=1, seed=42, task_name='sst2', warmup_ratio=0.1, weight_decay=1e-06)
Making checkpoint directory: save_models/search_ticket/search-robust-ticket_bert_glue-sst2_lr0.1_lambda0.5_adv-lr0.03_adv-step5_epochs20
Downloading and preparing dataset glue/sst2 to /home/jianwei/.cache/huggingface/datasets/glue/sst2/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad...
Dataset glue downloaded and prepared to /home/jianwei/.cache/huggingface/datasets/glue/sst2/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad. Subsequent calls will reuse this data.
Training...
Evaluating...
Epoch: 0, Loss_train:  0.2751, Loss_val:  5.6300, Lr:  5.001e-02, Accuracy: 0.8623853211009174, Regularizer:  0.9432, Pct_binary:  0.2082, Pct_Less0.5:  0.0556, 
Best performance so far.
Training...
Evaluating...
Epoch: 1, Loss_train:  0.2317, Loss_val:  6.4382, Lr:  1.000e-01, Accuracy: 0.8669724770642201, Regularizer:  0.7713, Pct_binary:  0.5502, Pct_Less0.5:  0.2717, 
Best performance so far.
Training...
Evaluating...
Epoch: 2, Loss_train:  0.1635, Loss_val:  4.3434, Lr:  9.444e-02, Accuracy: 0.9013761467889907, Regularizer:  0.5734, Pct_binary:  0.8072, Pct_Less0.5:  0.4382, 
Best performance so far.
Training...
Evaluating...
Epoch: 3, Loss_train:  0.1086, Loss_val:  4.5840, Lr:  8.889e-02, Accuracy: 0.8933486238532109, Regularizer:  0.4851, Pct_binary:  0.8986, Pct_Less0.5:  0.5133, 
Training...
Evaluating...
Epoch: 4, Loss_train:  0.0801, Loss_val:  5.2836, Lr:  8.333e-02, Accuracy: 0.9036697247706421, Regularizer:  0.4405, Pct_binary:  0.9338, Pct_Less0.5:  0.5522, 
Best performance so far.
Training...
Evaluating...
Epoch: 5, Loss_train:  0.0583, Loss_val:  5.5405, Lr:  7.777e-02, Accuracy: 0.8933486238532109, Regularizer:  0.4146, Pct_binary:  0.9488, Pct_Less0.5:  0.5750, 
Training...
Evaluating...
Epoch: 6, Loss_train:  0.0448, Loss_val:  5.2701, Lr:  7.222e-02, Accuracy: 0.9036697247706421, Regularizer:  0.3979, Pct_binary:  0.9568, Pct_Less0.5:  0.5896, 
Training...
Evaluating...
Epoch: 7, Loss_train:  0.0335, Loss_val:  7.6150, Lr:  6.666e-02, Accuracy: 0.896788990825688, Regularizer:  0.3860, Pct_binary:  0.9617, Pct_Less0.5:  0.6000, 
Training...
Evaluating...
Epoch: 8, Loss_train:  0.0253, Loss_val:  7.8403, Lr:  6.110e-02, Accuracy: 0.8876146788990824, Regularizer:  0.3772, Pct_binary:  0.9645, Pct_Less0.5:  0.6078, 
Training...
Evaluating...
Epoch: 9, Loss_train:  0.0191, Loss_val:  8.9862, Lr:  5.555e-02, Accuracy: 0.896788990825688, Regularizer:  0.3703, Pct_binary:  0.9666, Pct_Less0.5:  0.6138, 
Training...
Evaluating...
Epoch: 10, Loss_train:  0.0145, Loss_val:  9.1292, Lr:  4.999e-02, Accuracy: 0.8922018348623852, Regularizer:  0.3647, Pct_binary:  0.9686, Pct_Less0.5:  0.6185, 
Training...
Evaluating...
Epoch: 11, Loss_train:  0.0114, Loss_val:  9.8758, Lr:  4.443e-02, Accuracy: 0.8990825688073393, Regularizer:  0.3602, Pct_binary:  0.9702, Pct_Less0.5:  0.6223, 
Training...
Evaluating...
Epoch: 12, Loss_train:  0.0090, Loss_val:  11.3518, Lr:  3.888e-02, Accuracy: 0.8899082568807338, Regularizer:  0.3565, Pct_binary:  0.9718, Pct_Less0.5:  0.6253, 
Training...
Evaluating...
Epoch: 13, Loss_train:  0.0078, Loss_val:  11.5394, Lr:  3.332e-02, Accuracy: 0.8910550458715595, Regularizer:  0.3535, Pct_binary:  0.9731, Pct_Less0.5:  0.6277, 
Training...
Evaluating...
Epoch: 14, Loss_train:  0.0063, Loss_val:  11.4097, Lr:  2.776e-02, Accuracy: 0.8922018348623852, Regularizer:  0.3510, Pct_binary:  0.9742, Pct_Less0.5:  0.6296, 
Training...
Evaluating...
Epoch: 15, Loss_train:  0.0049, Loss_val:  12.4085, Lr:  2.221e-02, Accuracy: 0.8830275229357797, Regularizer:  0.3491, Pct_binary:  0.9752, Pct_Less0.5:  0.6311, 
Training...
Evaluating...
Epoch: 16, Loss_train:  0.0040, Loss_val:  12.5392, Lr:  1.665e-02, Accuracy: 0.8922018348623852, Regularizer:  0.3476, Pct_binary:  0.9760, Pct_Less0.5:  0.6322, 
Training...
Evaluating...
Epoch: 17, Loss_train:  0.0034, Loss_val:  12.6869, Lr:  1.109e-02, Accuracy: 0.8922018348623852, Regularizer:  0.3466, Pct_binary:  0.9767, Pct_Less0.5:  0.6329, 
Training...
Evaluating...
Epoch: 18, Loss_train:  0.0028, Loss_val:  12.7436, Lr:  5.538e-03, Accuracy: 0.8910550458715595, Regularizer:  0.3459, Pct_binary:  0.9771, Pct_Less0.5:  0.6334, 
Training...
Evaluating...
Epoch: 19, Loss_train:  0.0024, Loss_val:  12.6761, Lr:  0.000e+00, Accuracy: 0.8922018348623852, Regularizer:  0.3457, Pct_binary:  0.9773, Pct_Less0.5:  0.6335, 
Best dev metric: 0.9036697247706421 in Epoch: 4
